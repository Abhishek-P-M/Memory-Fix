<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Memory Fix | Numbers</title>
<style>
body {
  font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
  margin:0;
  padding:20px;
  background: linear-gradient(135deg, #f0f9ff, #cbebff);
  color:#333;
  text-align:center;
}

h2 { color: #2c3e50; font-size:32px; margin-bottom:20px; }
label { font-weight:bold; margin:5px; }
select,input { margin:5px; padding:8px 12px; font-size:16px; border:2px solid #ccc; border-radius:8px; outline:none; transition:0.2s; }
select:focus,input:focus { border-color:#3498db; box-shadow:0 0 6px rgba(52,152,219,0.4); }

button {
  margin:10px; padding:14px 28px; font-size:18px; font-weight:bold; border:none; border-radius:12px;
  cursor:pointer; background: linear-gradient(90deg, #27ae60, #2ecc71); color:white;
  transition: transform 0.2s, opacity 0.2s;
}
button:hover { transform:scale(1.05); opacity:0.9; }
button:active { transform:scale(0.95); }

#currentNumbers {
  font-size:36px; margin:25px auto 15px auto; padding:20px; width:fit-content;
  background:#27ae60; color:white; border-radius:15px; font-weight:bold; box-shadow:0px 4px 10px rgba(0,0,0,0.2);
}

ul { list-style:none; padding:0; display:flex; flex-wrap:wrap; justify-content:center; gap:10px; }
li {
  background:#f8f9fa; margin:5px; padding:12px 20px; min-width:70px; border-radius:8px;
  font-size:22px; font-weight:bold; color:#2c3e50; box-shadow:0px 2px 6px rgba(0,0,0,0.15);
}

/* Reproduction */
#placeholders,#deck { display:flex; flex-wrap:wrap; gap:10px; justify-content:center; margin-top:20px; }
.number-placeholder, .number-card {
  width:60px; height:60px; display:flex; align-items:center; justify-content:center; border-radius:8px;
  font-weight:bold; font-size:18px; background:#fff; border:1px solid #333; cursor:grab;
}
.number-placeholder { border:2px dashed #999; cursor:default; }
</style>
</head>
<body>

<h2>üé≤ Number Memorization</h2>

<div id="setup">
  <label>Total Numbers:</label><input type="number" id="totalNumbers" value="20" min="1">
  <label>Numbers per Group:</label>
  <select id="groupSize"><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option><option selected>6</option></select>
  <label>Memorization Timer (min):</label><input type="number" id="memTimerMin" value="1" min="1">
  <br>
  <label>Choose digits:</label>
  <select id="digitSelect">
    <option value="2">2-digit</option>
    <option value="3">3-digit</option>
    <option value="3prefix">3-digit with custom prefix</option>
  </select>
  <label id="prefixLabel" style="display:none;">Prefix:</label>
  <input type="number" id="prefixInput" min="0" max="9" value="0" style="display:none;">
  <br>
  <button onclick="startMemorization()">Start ‚û°Ô∏è</button>
  <button onclick="resetList()">Reset üîÑ</button>
</div>

<div id="memorization" style="display:none;">
  <h3>Memorization</h3>
  <div id="currentNumbers">--</div>
  <button onclick="nextGroup()">Next Group ‚è≠Ô∏è</button>
  <ul id="numberList"></ul>
</div>

<div id="recollection" style="display:none;">
  <h3>Recollection (1 min)</h3>
  <p>Try to recall the numbers. <button onclick="skipRecollection()">Skip</button></p>
</div>

<div id="reproduction" style="display:none;">
  <h3>Reproduction Phase</h3>
  <div id="placeholders"></div>
  <div id="deck"></div>
  <button onclick="submitReproduction()">Submit</button>
</div>

<div id="results" style="display:none;">
  <h3>Results</h3>
  <p id="score"></p>
</div>

<script>
let allNumbers=[],lockedNumbers=[],currentIndex=0,groupSize=6,totalNumbers=20;
let memorizeTimer=null,userChoices=[];

// Show/hide prefix
document.getElementById("digitSelect").addEventListener("change", function() {
  const prefixLabel = document.getElementById("prefixLabel");
  const prefixInput = document.getElementById("prefixInput");
  if(this.value==="3prefix"){ prefixLabel.style.display="inline"; prefixInput.style.display="inline"; }
  else { prefixLabel.style.display="none"; prefixInput.style.display="none"; }
});

// Generate number
function generateNumber() {
  const digitChoice=document.getElementById("digitSelect").value;
  if(digitChoice==="2") return String(Math.floor(Math.random()*100)).padStart(2,'0');
  if(digitChoice==="3") return String(Math.floor(Math.random()*1000)).padStart(3,'0');
  if(digitChoice==="3prefix") {
    const prefix=document.getElementById("prefixInput").value;
    const suffix=String(Math.floor(Math.random()*100)).padStart(2,'0');
    return prefix+suffix;
  }
}

// Start memorization
function startMemorization(){
  totalNumbers=parseInt(document.getElementById("totalNumbers").value);
  groupSize=parseInt(document.getElementById("groupSize").value);
  const memMinutes=parseInt(document.getElementById("memTimerMin").value);

  // Generate numbers
  allNumbers=[];
  lockedNumbers=[];
  for(let i=0;i<totalNumbers;i++) allNumbers.push(generateNumber());
  currentIndex=0;
  userChoices=[];
  updateList();

  // Show memorization section
  document.getElementById("setup").style.display="none";
  document.getElementById("memorization").style.display="block";
  displayGroup(groupSize);

  // Memorization timer
  clearTimeout(memorizeTimer);
  memorizeTimer=setTimeout(()=>{
    alert("Memorization time over!");
    startRecollection();
  }, memMinutes*60*1000);
}

// Display group
function displayGroup(size){
  if(currentIndex>=allNumbers.length){ alert("All numbers shown!"); return; }
  const group=[];
  for(let i=0;i<size;i++){
    if(currentIndex+i<allNumbers.length) group.push(allNumbers[currentIndex+i]);
  }
  document.getElementById("currentNumbers").textContent=group.join(" ");
  lockedNumbers.push(...group);
  currentIndex+=size;
  updateList();
}

// Next Group
function nextGroup(){ displayGroup(groupSize); }

// Update locked list
function updateList(){
  const list=document.getElementById("numberList");
  list.innerHTML="";
  lockedNumbers.forEach(n=>{
    const li=document.createElement("li"); li.textContent=n; list.appendChild(li);
  });
}

// Reset
function resetList(){
  clearTimeout(memorizeTimer);
  allNumbers=[]; lockedNumbers=[]; currentIndex=0; userChoices=[];
  document.getElementById("currentNumbers").textContent="--";
  document.getElementById("numberList").innerHTML="";
  document.getElementById("memorization").style.display="none";
  document.getElementById("recollection").style.display="none";
  document.getElementById("reproduction").style.display="none";
  document.getElementById("results").style.display="none";
  document.getElementById("setup").style.display="block";
}

// Recollection
function startRecollection(){
  document.getElementById("memorization").style.display="none";
  document.getElementById("recollection").style.display="block";
  setTimeout(()=>{ skipRecollection(); }, 60000); // 1 min
}

function skipRecollection(){
  document.getElementById("recollection").style.display="none";
  startReproduction();
}

// Reproduction
function startReproduction(){
  document.getElementById("reproduction").style.display="block";
  renderReproduction();
}

function renderReproduction(){
  const placeholdersDiv=document.getElementById("placeholders");
  const deckDiv=document.getElementById("deck");
  placeholdersDiv.innerHTML=''; deckDiv.innerHTML=''; userChoices=Array(allNumbers.length).fill(null);

  allNumbers.forEach((_,i)=>{
    const ph=document.createElement('div'); ph.className='number-placeholder'; ph.dataset.index=i;
    ph.ondragover=e=>e.preventDefault();
    ph.ondrop=e=>{
      const cardIndex=e.dataTransfer.getData('text');
      const cardDiv=document.getElementById('num-'+cardIndex);
      ph.innerHTML=''; ph.appendChild(cardDiv);
      userChoices[i]=parseInt(cardIndex);
    };
    placeholdersDiv.appendChild(ph);
  });

  allNumbers.forEach((num,i)=>{
    const numDiv=document.createElement('div'); numDiv.id='num-'+i;
    numDiv.className='number-card'; numDiv.draggable=true; numDiv.textContent=num;
    numDiv.ondragstart=e=>{ e.dataTransfer.setData('text',i); };
    deckDiv.appendChild(numDiv);
  });
}

// Submit reproduction
function submitReproduction(){
  let correct=0;
  userChoices.forEach((userIdx,i)=>{
    if(userIdx!==null && allNumbers[userIdx]===allNumbers[i]) correct++;
  });
  let score10=((correct/allNumbers.length)*10).toFixed(2);
  document.getElementById("score").textContent=`Correct: ${correct}/${allNumbers.length} ‚Üí Score: ${score10}/10`;
  document.getElementById("reproduction").style.display="none";
  document.getElementById("results").style.display="block";
  saveNumbersStats(score10);
}

// Save stats
function saveNumbersStats(score){
  let stats=JSON.parse(localStorage.getItem('numbersStats'))||[];
  stats.push({date:new Date().toISOString().split('T')[0],total:allNumbers.length,score:parseFloat(score)});
  localStorage.setItem('numbersStats',JSON.stringify(stats));
}
</script>

</body>
</html>
